#ifndef VIDEO_H
#define VIDEO_H

#include <port.h>
#include <stdint.h>

#define VGA_MISC_PORT		0x3C2
#define VGA_SEQ_INDEX_PORT	0x3C4
#define VGA_SEQ_DATA_PORT	0x3C5
#define VGA_CRTC_INDEX_PORT	0x3D4
#define VGA_CRTC_DATA_PORT	0x3D5
#define VGA_GC_INDEX_PORT	0x3CE
#define VGA_GC_DATA_PORT	0x3CF
#define VGA_AC_INDEX_PORT	0x3C0
#define VGA_AC_DATA_PORT	0x3C0
#define VGA_INSTAT_READ		0x3DA

uint8_t g_720x480x2[] =
{
/* MISC */
	0xE3,
/* SEQ */
	0x03, 0x01, 0x0F, 0x00, 0x06,
/* CRTC */
	0x5F, 0x4F, 0x50, 0x82, 0x54, 0x80, 0x0B, 0x3E,
	0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xEA, 0x0C, 0xDF, 0x28, 0x00, 0xE7, 0x04, 0xE3,
	0xFF,
/* GC */
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x0F,
	0xFF,
/* AC */
	0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x14, 0x07,
	0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
	0x01, 0x00, 0x0F, 0x00, 0x00
};
uint8_t g_640x480x16[] =
{
/* MISC */
	0xE3,
/* SEQ */
	0x03, 0x01, 0x08, 0x00, 0x06,
/* CRTC */
	0x5F, 0x4F, 0x50, 0x82, 0x54, 0x80, 0x0B, 0x3E,
	0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xEA, 0x0C, 0xDF, 0x28, 0x00, 0xE7, 0x04, 0xE3,
	0xFF,
/* GC */
	0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x05, 0x0F,
	0xFF,
/* AC */
	0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x14, 0x07,
	0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
	0x01, 0x00, 0x0F, 0x00, 0x00
};
unsigned char g_640x480x2[] =
{
/* MISC */
	0xE3,
/* SEQ */
	0x03, 0x01, 0x0F, 0x00, 0x06,
/* CRTC */
	0x5F, 0x4F, 0x50, 0x82, 0x54, 0x80, 0x0B, 0x3E,
	0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0xEA, 0x0C, 0xDF, 0x28, 0x00, 0xE7, 0x04, 0xE3,
	0xFF,
/* GC */
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x0F,
	0xFF,
/* AC */
	0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x14, 0x07,
	0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
	0x01, 0x00, 0x0F, 0x00, 0x00
};

void writereg_video(uint8_t * regs) {
	uint16_t i;
	outb(*regs, VGA_MISC_PORT);
	regs++;

	for (i=0; i<5; i++) {
		outb(i, VGA_SEQ_INDEX_PORT);
		outb(*regs, VGA_SEQ_DATA_PORT);
		regs++;
	}
	outb(0x03, VGA_CRTC_INDEX_PORT);
        outb(inb(VGA_CRTC_DATA_PORT) | 0x80, VGA_CRTC_DATA_PORT);
        outb(0x11, VGA_CRTC_INDEX_PORT);
        outb(inb(VGA_CRTC_DATA_PORT) & 0x7f, VGA_CRTC_DATA_PORT);
	for (i = 0; i < 25; i++) {
		outb(i, VGA_CRTC_INDEX_PORT);
		outb(*regs, VGA_CRTC_DATA_PORT);
		regs++;
	}
	for(i = 0; i < 9; i++) {
		outb(i, VGA_GC_INDEX_PORT);
		outb(*regs, VGA_GC_DATA_PORT);
		regs++;
	}
	for(i = 0; i < 21; i++) {
		(void)inb(VGA_INSTAT_READ);
		outb(i, VGA_AC_INDEX_PORT);
		outb(*regs, VGA_AC_DATA_PORT);
		regs++;
	}
	(void)inb(VGA_INSTAT_READ);
	outb(0x20, VGA_AC_INDEX_PORT);
}

#endif
